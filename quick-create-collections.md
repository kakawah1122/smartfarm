# 快速创建数据库集合指南

## 🚨 紧急修复方案

由于疫苗接种功能代码引用了尚未创建的数据库集合，导致提交失败。

### ⚡ 立即解决步骤

#### 1. 登录微信云开发控制台
```
https://console.cloud.tencent.com/tcb
```

#### 2. 快速创建3个集合
在"数据库" → "集合"中，点击"新建集合"：

1. **`prevention_records`** - 预防记录
2. **`finance_records`** - 财务记录  
3. **`overview_stats`** - 概览统计

**注意：集合名称必须完全一致，区分大小写！**

#### 3. 暂时跳过权限配置
- 创建集合时，可以先使用默认权限
- 稍后按照完整指南配置权限

#### 4. 重新部署云函数
创建集合后：
1. 在项目中取消注释云函数代码
2. 重新上传部署 `breeding-todo` 云函数

### 🔧 当前临时状态

我已经临时修改了云函数代码：
- ✅ 疫苗接种表单可以正常提交
- ✅ 任务状态会正确更新为已完成
- ⚠️ 预防记录和财务记录暂时只记录到控制台日志
- ⚠️ 等集合创建后需要取消注释代码

### 📋 验证步骤

集合创建后，测试疫苗接种功能：
1. 提交疫苗接种表单
2. 检查是否显示成功提示
3. 查看云函数日志确认数据记录

### 🎯 完整恢复步骤

集合创建完成后，需要：

1. **取消注释云函数代码**：
   ```javascript
   // 在 cloudfunctions/breeding-todo/index.js 中
   // 找到 "TODO: 集合创建完成后取消注释" 注释
   // 取消注释下面的代码块
   ```

2. **重新部署云函数**：
   - 右击 `cloudfunctions/breeding-todo`
   - 选择"上传并部署：云端安装依赖"

3. **测试完整功能**：
   - 提交疫苗接种表单
   - 检查数据库中是否有新记录
   - 验证预防管理和财务管理模块

### ❗ 集合创建最低要求

每个集合只需要：
- ✅ 集合名称正确
- ✅ 能够读写访问
- ⚠️ 权限可以后续优化

### 🆘 如果仍然失败

如果创建集合后仍有问题：
1. 检查集合名称拼写
2. 确认环境选择正确
3. 查看云函数详细错误日志
4. 联系技术支持

---

**紧急联系**: 如需帮助，请提供：
- 错误截图
- 云函数日志
- 集合创建状态
