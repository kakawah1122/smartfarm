# employeeManage 云函数部署指南

## 🚨 问题现象
生成邀请码时出现 "FunctionName parameter could not be found" 错误，说明 `employeeManage` 云函数还未部署。

## 📋 部署步骤

### 步骤1：确认云函数文件
确认 `cloudfunctions/employeeManage/` 目录下有以下文件：
- ✅ `index.js`（主函数文件）
- ✅ `package.json`（依赖配置）
- ✅ `node_modules/`（依赖已安装）

### 步骤2：在微信开发者工具中部署

1. **打开微信开发者工具**
2. **找到云函数目录**
   - 展开 `cloudfunctions` 文件夹
   - 找到 `employeeManage` 文件夹

3. **部署云函数**
   - 右键点击 `employeeManage` 文件夹
   - 选择 "**上传并部署：云端安装依赖**"
   - 等待部署完成（通常需要1-2分钟）

4. **验证部署成功**
   - 部署成功后，文件夹图标会变成云朵形状 ☁️
   - 控制台会显示 "上传成功" 或类似信息

### 步骤3：测试部署结果

1. **在小程序中测试**
   - 进入测试页面：个人中心 → 权限测试
   - 点击 "**云函数测试**" 按钮
   - 如果显示成功，说明部署正确

2. **测试邀请码生成**
   - 确保已登录且为管理员
   - 点击 "**生成邀请码**" 按钮
   - 成功生成邀请码说明功能正常

## 🔧 常见问题解决

### 问题1：部署失败
**现象**：右键菜单中没有部署选项或部署报错

**解决方案**：
1. 确认云开发环境已开通
2. 检查网络连接
3. 重启微信开发者工具
4. 确认项目配置正确

### 问题2：依赖安装失败
**现象**：部署时提示依赖安装错误

**解决方案**：
```bash
# 在终端中手动安装依赖
cd cloudfunctions/employeeManage
npm install
```

### 问题3：权限错误
**现象**：部署成功但调用时提示权限不足

**解决方案**：
1. 确认用户是管理员角色
2. 检查用户权限包含 `employee.invite` 或 `all`
3. 重新登录获取最新权限

### 问题4：云函数调用超时
**现象**：调用云函数时长时间无响应

**解决方案**：
1. 检查云开发环境状态
2. 查看云函数日志
3. 重新部署云函数

## 📝 部署清单

部署完成后，请确认以下项目：

- [ ] employeeManage 云函数部署成功
- [ ] 云函数测试通过
- [ ] 用户角色为管理员
- [ ] 生成邀请码功能正常
- [ ] 员工管理页面可正常访问

## 🎯 快速验证方法

运行以下测试序列：

1. **云函数连接测试**：测试页面 → 云函数测试 → 应显示成功
2. **权限测试**：测试页面 → 管理员权限 → 确认为管理员
3. **邀请码测试**：测试页面 → 生成邀请码 → 成功生成8位码
4. **完整功能测试**：员工管理页面 → 邀请员工 → 正常工作

## 📞 获取帮助

如果仍然遇到问题：

1. **查看控制台日志**：在微信开发者工具控制台查看详细错误信息
2. **检查云函数日志**：在云开发控制台查看云函数执行日志
3. **重新部署**：删除云函数后重新上传部署
4. **环境重置**：清除本地缓存，重新初始化云开发环境

---

**注意**：确保在微信开发者工具中操作，而不是在终端或其他环境中部署云函数。
