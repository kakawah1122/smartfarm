# 生产管理系统数据库索引配置指南

## 📊 推荐索引配置

### 1. entry_records（入栏记录）
```json
{
  "userId": 1,           // 用户查询优化
  "batchNumber": 1,      // 批次号唯一查询
  "entryDate": -1,       // 按日期排序查询
  "status": 1,           // 状态筛选
  "createTime": -1       // 时间排序
}
```

**复合索引：**
```json
{
  "userId": 1,
  "entryDate": -1
}
```

### 2. exit_records（出栏记录）
```json
{
  "userId": 1,           // 用户查询
  "batchNumber": 1,      // 批次关联查询
  "exitDate": -1,        // 日期排序
  "status": 1,           // 状态筛选
  "customer": 1          // 客户查询
}
```

**复合索引：**
```json
{
  "batchNumber": 1,
  "exitDate": -1
}
```

### 3. materials（物料表）
```json
{
  "category": 1,         // 分类查询
  "isActive": 1,         // 状态过滤
  "name": 1              // 名称搜索
}
```

### 4. material_records（物料记录）
```json
{
  "userId": 1,           // 用户查询
  "materialId": 1,       // 物料关联
  "type": 1,             // 类型筛选
  "recordDate": -1       // 日期排序
}
```

**复合索引：**
```json
{
  "materialId": 1,
  "recordDate": -1
}
```

### 5. inventory_logs（库存流水）
```json
{
  "materialId": 1,       // 物料查询
  "operationTime": -1    // 时间排序
}
```

### 6. file_records（文件记录）
```json
{
  "userId": 1,           // 用户查询
  "relatedType": 1,      // 关联类型
  "relatedId": 1,        // 关联ID
  "isActive": 1          // 状态过滤
}
```

## 🛠️ 如何创建索引

### 在云开发控制台操作：

1. **进入数据库页面**
2. **选择对应集合**
3. **点击"索引"标签**
4. **点击"添加索引"**

### 索引创建示例：

#### 单字段索引：
```json
{
  "userId": 1
}
```

#### 复合索引：
```json
{
  "userId": 1,
  "entryDate": -1
}
```

#### 文本索引（搜索功能）：
```json
{
  "name": "text",
  "breed": "text"
}
```

## ⚡ 索引创建优先级

### 🔥 立即创建（高优先级）：
- `userId` 索引（所有主要集合）
- `entryDate`、`exitDate`、`recordDate` 降序索引
- `batchNumber` 索引

### 📈 后期创建（中优先级）：
- 复合索引（根据查询模式）
- 状态字段索引

### 🔍 可选创建（低优先级）：
- 文本搜索索引
- 特殊查询字段索引

## 💡 索引创建时机

### 阶段1：系统上线前
```bash
✅ 基础单字段索引
✅ 用户ID索引  
✅ 日期字段索引
```

### 阶段2：数据量增长后（1000+记录）
```bash
✅ 复合索引
✅ 查询优化索引
```

### 阶段3：性能优化阶段（10000+记录）
```bash
✅ 高级索引策略
✅ 查询分析优化
```

## 🎯 当前建议

**您现在可以：**

1. **跳过索引创建** - 先让系统跑起来
2. **等有数据后再创建** - 根据实际查询模式优化
3. **或者创建基础索引** - 为将来性能做准备

**最简单的选择：先不创建索引，系统运行正常后再优化！**
