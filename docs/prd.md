1. 项目概述
1.1. 项目背景
为解决传统养鹅业管理粗放、信息不透明、疾病防控难、财务核算复杂等问题，开发一款集生产管理、健康监控、知识学习和财务分析于一体的“智慧养鹅”微信小程序。通过数字化手段提升养殖效率与经济效益。

1.2. 项目目标
生产标准化： 规范入栏、出栏、物料管理等流程。

健康可追溯： 建立鹅群健康档案，借助AI技术快速获取疾病诊疗建议。

财务清晰化： 自动关联生产与健康数据，形成财务报表，并通过AI提供养殖建议。

知识结构化： 为养殖户提供系统化的养鹅知识库。

权限可控化： 区分管理员与员工权限，保障数据安全。

1.3. 用户角色
角色	权限描述
管理员 (Admin)	拥有系统的全部操作权限，包括所有数据的增删改查、员工账号管理、财务审核、系统设置等。
员工 (Staff)	仅拥有部分数据的查看和创建权限（如创建入栏记录、提交报销申请），只能查看自己创建的记录。
1.4. 技术栈
前端： 微信小程序原生框架 (WXML, WXSS, JS)

后端： 微信小程序云开发 (CloudBase)

云数据库：存储所有业务数据

云函数：处理复杂业务逻辑、调用第三方API（天气、AI大模型）

云存储：存放知识库文章图片、用户头像等文件

AI集成： 通过云函数调用第三方AI大模型API（如腾讯云TI、文心一言、通义千问等）

2. 功能模块详述
2.1. 首页
2.1.1. 天气模块
功能描述： 展示养殖场所在地的实时天气和未来预报。

实现方式： 调用第三方天气API（如和风天气），通过云函数获取并缓存数据。

显示内容： 温度、湿度、天气状况、风力、温馨提示（如“今日降温，注意鹅舍保温”）。

2.1.2. 待办事项模块
功能描述： 提醒用户今日急需完成的任务。

数据来源： 自动从其他模块生成，如：

健康管理： “今日有10只鹅需接种疫苗”

生产管理： “3号鹅舍预计今日出栏”

交互： 点击可跳转到相应模块的详情页。

2.1.3. 今日鹅价组件
功能描述： 每日更新主要地区的成鹅和鹅苗价格。

实现方式：

方案A（自动）： 云函数定时触发，爬取或调用农业价格API。

方案B（手动）： 管理员在后台手动更新价格。

显示内容： 成鹅价格（元/斤）、鹅苗价格（元/羽）、更新日期、价格趋势箭头（与昨日对比）。

2.2. 生产页面
2.2.1. 生产管理
入栏管理：

功能： 记录新鹅苗入栏信息。

字段： 入栏日期、品种、数量、供应商、单价、总金额、备注、经办人（自动记录创建者）。

权限： 员工可创建，管理员可增删改查所有记录。

出栏管理：

功能： 记录成鹅出栏销售信息。

字段： 出栏日期、客户、数量、单价、总金额、平均重量、备注、经办人。

权限： 同上。

物料出入库：

功能： 管理饲料、药品等物料的采购和领用。

字段： 类型（采购/领用）、物品名称、数量、单价、总金额、日期、经办人、仓库现存总量（自动计算）。

权限： 同上。

2.2.2. 健康管理
健康记录：

功能： 记录鹅群的日常健康观察、诊疗情况。

字段： 日期、鹅舍编号、症状描述、处理措施（用药记录）、负责人。

权限： 员工可创建，管理员可增删改查所有记录。

疫苗管理：

功能： 制定和执行疫苗计划。

字段： 疫苗名称、接种日期、鹅舍编号/数量、下次接种日期提醒、负责人。

AI诊疗建议 (核心功能)：

功能： 用户输入症状（如“鹅精神萎靡、拉稀”），调用AI大模型获取可能的疾病诊断和处理建议。

实现： 通过云函数将用户输入的结构化信息发送至AI API，将返回结果展示并同时保存到健康记录中。

注意： 需在界面明确提示“AI建议仅供参考，请结合专业兽医诊断”。

2.2.3. 知识库
功能描述： 一个养鹅知识的文章库。

内容分类： 饲养技术、疾病防治、品种介绍、市场分析等。

功能： 文章列表、文章详情、收藏、搜索。

管理： 仅管理员可在后台管理（上传、编辑、删除）文章。

2.3. 个人中心页面
2.3.1. 财务管理模块
核心逻辑： 自动从【生产管理】和【健康管理】模块关联生成收支记录。

收入： 出栏记录 -> 自动生成“销售收入”。

支出： 入栏记录 -> “鹅苗采购支出”；物料采购 -> “物料采购支出”；健康记录中的用药 -> “药品支出”。

功能：

财务仪表盘： 展示月度/年度总收入、总支出、利润曲线图。

收支明细： 所有自动生成和手动补充的收支记录列表，可筛选。

报销申请（员工）： 员工可提交与养殖相关的个人费用报销（如交通费），状态为“待审核、已通过、已拒绝”。

采购申请（员工）： 员工可提交物料采购申请，由管理员审核后，管理员再去执行采购入库。

AI养殖建议 (核心功能)：

功能： 基于当前的财务数据（成本、收入）、鹅价行情、生产指标（料肉比、成活率），调用AI大模型生成个性化的养殖建议报告。

示例： “根据近期鹅苗价格下降和您的成活率，建议适当补栏；当前饲料成本较高，可考虑更换XX品牌饲料。”

2.3.2. 用户与权限管理
管理员功能：

员工账号的增删改查。

审核员工的报销和采购申请。

角色权限分配。

员工功能：

查看和编辑自己的个人信息。

查看自己提交的报销和采购申请记录及状态。

2.3.3. 系统设置
功能： 修改小程序的基本设置（仅管理员可见）。

包含： 养殖场信息设置、天气位置设置、AI服务配置、数据备份与导出等。

3. 数据模型（云数据库集合设计示例）
users (用户表): _id, openid, role(admin/staff), name, avatarUrl, ...

weather_cache (天气缓存表): _id, data, updateTime

goose_price (鹅价表): _id, adult_price, gosling_price, date

entry_records (入栏表): _id, date, type, quantity, unit_price, total, operator(关联users._id), ...

exit_records (出栏表): ... (类似入栏表)

inventory_logs (物料日志): _id, type(in/out), item_name, quantity, ..., operator

health_records (健康记录): _id, date, symptoms, action, ai_advice(存储AI返回结果), operator

vaccine_records (疫苗记录): _id, name, date, next_date, operator

articles (知识库文章): _id, title, content, category, createTime

financial_records (财务记录): _id, type(income/expense), amount, category(销售/采购/医药...), related_id(关联原记录ID), date, note

reimbursement_requests (报销申请): _id, applicant, amount, reason, status, createTime

purchase_requests (采购申请): _id, applicant, item, quantity, reason, status, createTime

4. 权限设计策略
前端路由拦截： 在进入管理员页面（如员工管理、系统设置）前，通过云函数getUserInfo校验用户角色，非管理员则提示无权限并重定向。

数据库权限：

员工： 使用小程序端直接操作数据库时，在查询条件中自动添加 operator == .openid 或 applicant == .openid，确保其只能看到自己的数据。

管理员： 通过云函数操作数据库，云函数端拥有最高数据库权限，可操作所有数据。

5. 项目里程碑 (Milestone)
阶段	主要任务	预计时间
M1: 基础框架与认证	小程序初始化、云环境搭建、用户登录与权限获取	1周
M2: 生产管理模块	完成入栏、出栏、物料管理的CRUD操作	2周
M3: 首页与健康模块	集成天气、鹅价、待办；完成健康记录和疫苗功能	2周
M4: AI功能集成	云函数对接AI API，实现诊疗和建议功能	1周
M5: 财务管理模块	实现财务自动关联、报表、报销采购流程	2周
M6: 知识库与个人中心	完成文章模块、个人信息、系统设置	1周
M7: 测试与优化	全面测试、性能优化、UI调整、发布上线	1周
6. 风险与假设
风险1： AI大模型API的稳定性和费用成本。

应对： 选择多家服务商备用，并在云函数中做好异常处理和限流。

风险2： 鹅价数据的来源可靠性。

应对： 优先采用手动录入，后期再寻找稳定的农业数据接口。

假设： 用户群体为有一定智能手机操作能力的养殖户，网络环境基本稳定。