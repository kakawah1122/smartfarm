# 死亡详情弹窗滚动修复说明

## 问题描述
死亡记录详情弹窗在内容较多时无法完全显示，底部的"确定"按钮被遮挡，用户无法看到完整的成本分解信息。

## 问题原因
1. **scroll-view 高度问题**：scroll-view 组件需要固定高度才能正常滚动，之前使用 flex 布局导致高度不确定
2. **样式冲突**：多个地方设置了滚动相关样式，造成冲突
3. **高度计算错误**：没有正确预留头部和按钮的空间

## 修复方案

### 1. bottom-popup 组件优化
**文件**：`/miniprogram/components/bottom-popup/`

#### bottom-popup.wxml
- 简化 scroll-view 配置
- 启用 enhanced 模式提升性能
- 显示滚动条，让用户知道可以滚动

```xml
<scroll-view 
  class="popup-content" 
  scroll-y="{{true}}"
  show-scrollbar="{{true}}"
  enhanced="{{true}}"
  bounces="{{false}}"
>
  <slot></slot>
</scroll-view>
```

#### bottom-popup.scss
- 设置固定高度：`calc(85vh - 240rpx)`
- 85vh 是弹窗最大高度
- 减去 240rpx（头部 120rpx + 按钮 120rpx）

```scss
.popup-content {
  flex: 1;
  min-height: 200rpx;
  height: calc(85vh - 240rpx);
  max-height: calc(85vh - 240rpx);
  padding: 16rpx 24rpx;
  box-sizing: border-box;
}
```

### 2. death-record-detail-popup 组件调整
**文件**：`/miniprogram/components/death-record-detail-popup/death-record-detail-popup.scss`

- 移除内容容器的滚动样式
- 让父组件的 scroll-view 统一处理滚动

```scss
.record-detail-content {
  padding: 0 !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 0 !important;
  min-height: 400rpx !important;
  /* 由父组件的 scroll-view 处理滚动 */
}
```

## 测试要点

### 1. 功能测试
- ✅ 死亡详情弹窗可以正常滚动
- ✅ 所有内容都能显示（基本信息、死亡统计、成本分解、备注等）
- ✅ 底部"确定"按钮始终可见
- ✅ 滚动条正常显示

### 2. 兼容性测试
- 测试不同内容长度的死亡记录
- 测试有/无成本分解的记录
- 测试有/无修正信息的记录
- 测试不同手机屏幕尺寸

### 3. 性能测试
- 滚动流畅度
- 内容加载速度
- 内存占用情况

## 使用示例

在健康管理页面查看死亡记录：

1. 进入"健康管理"页面
2. 切换到"异常&死亡"标签
3. 点击任意死亡记录
4. 弹窗显示，内容较多时可以上下滚动查看

## 注意事项

1. **滚动条显示**：为了用户体验，现在显示滚动条，让用户知道可以滚动
2. **高度计算**：如果修改了头部或按钮的高度，需要相应调整 `.popup-content` 的高度计算
3. **真机测试**：建议在真机上测试滚动效果，模拟器可能有差异

## 后续优化建议

1. **动态高度计算**：可以通过 JS 动态获取头部和按钮的实际高度，更精确地计算内容区域高度
2. **滚动位置记忆**：记录用户的滚动位置，下次打开时恢复
3. **懒加载**：如果内容特别多，可以考虑分段加载

## 更新记录

- **2025-01-19**：修复死亡详情弹窗滚动问题
  - 设置 scroll-view 固定高度
  - 移除样式冲突
  - 优化滚动体验
