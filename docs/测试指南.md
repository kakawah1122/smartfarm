# 测试指南

**测试日期**: 2025年1月  
**测试范围**: 合规修复后的功能验证

---

## 🧪 日志功能测试

### 测试步骤

1. **在微信开发者工具中打开小程序**

2. **测试开发环境日志**
   ```javascript
   // 在控制台执行
   const app = getApp()
   app.globalData.DEBUG_LOG = true
   
   // 或者使用本地存储
   wx.setStorageSync('DEBUG_LOG', 'true')
   ```

3. **触发日志输出**
   - 执行会触发 `logger.log()` 的操作
   - 检查控制台是否输出 `[DEBUG]` 日志

4. **测试生产环境（关闭日志）**
   ```javascript
   // 在控制台执行
   const app = getApp()
   app.globalData.DEBUG_LOG = false
   
   // 或者
   wx.setStorageSync('DEBUG_LOG', 'false')
   ```

5. **验证结果**
   - ✅ 开启时：应该看到 `[DEBUG]` 和 `[WARN]` 日志
   - ✅ 关闭时：不应该看到 `[DEBUG]` 和 `[WARN]` 日志
   - ✅ 始终：应该看到 `[ERROR]` 日志

---

## 📱 页面布局测试

### 1. cured-records-list 页面测试

**测试设备**:
- iPhone（不同型号）
- Android（不同品牌）

**测试步骤**:
1. 进入治愈记录列表页面
2. 检查以下内容：
   - [ ] 页面高度填满屏幕（无底部空白过大）
   - [ ] 导航栏显示正常
   - [ ] 列表滚动流畅
   - [ ] 底部安全区域正确处理（iPhone X 及以上）
   - [ ] 统计卡片显示正常
   - [ ] 空状态显示正常

**预期结果**:
- ✅ 页面使用 Flex 布局，自适应高度
- ✅ 底部空白最小化
- ✅ 在不同设备上显示一致

### 2. treatment-records-list 页面测试

**测试步骤**:
1. 进入治疗中记录列表页面
2. 检查以下内容：
   - [ ] 页面布局正常
   - [ ] 加载状态显示正常
   - [ ] 空状态显示正常
   - [ ] 列表滚动流畅
   - [ ] 记录卡片显示正常

**预期结果**:
- ✅ 使用 Flex 布局
- ✅ 无固定高度问题
- ✅ 滚动流畅

---

## 🎨 详情弹窗测试

### cured-record-detail-popup 组件测试

**测试步骤**:
1. 进入治愈记录列表页面
2. 点击一条记录
3. 检查弹窗：
   - [ ] 弹窗打开动画流畅
   - [ ] 弹窗内容显示正确
   - [ ] 所有字段显示正常
   - [ ] 用药记录显示正常
   - [ ] 治疗方案显示正常
4. 关闭弹窗：
   - [ ] 弹窗关闭动画流畅
   - [ ] 关闭时无数据闪烁
   - [ ] 延迟清空数据正常（300ms）

**预期结果**:
- ✅ 弹窗动画流畅
- ✅ 内容显示正确
- ✅ 无数据闪烁
- ✅ 符合项目规范

---

## 🔍 功能回归测试

### 核心功能测试清单

#### 1. 登录/注册
- [ ] 登录功能正常
- [ ] 注册功能正常
- [ ] 权限检查正常
- [ ] 错误提示正常

#### 2. 数据加载
- [ ] 列表数据加载正常
- [ ] 分页加载正常
- [ ] 下拉刷新正常
- [ ] 加载状态显示正常
- [ ] 错误处理正常

#### 3. 页面跳转
- [ ] 页面跳转正常
- [ ] 参数传递正常
- [ ] 返回功能正常
- [ ] Tab 切换正常

#### 4. 表单提交
- [ ] 表单验证正常
- [ ] 提交成功提示正常
- [ ] 提交失败处理正常
- [ ] 数据保存正常

---

## 🐛 常见问题排查

### 问题1: 日志不输出

**可能原因**:
- DEBUG_LOG 未开启
- logger 导入路径错误

**解决方法**:
```javascript
// 检查导入
import { logger } from './utils/logger'  // 确认路径正确

// 开启调试
const app = getApp()
app.globalData.DEBUG_LOG = true
```

### 问题2: 页面布局异常

**可能原因**:
- CSS 变量未定义
- 导航栏高度计算错误

**解决方法**:
- 检查 `--status-bar-height` 和 `--navbar-height` 变量
- 确认使用 Flex 布局而非固定高度

### 问题3: 弹窗数据闪烁

**可能原因**:
- 延迟清空时间不足
- 数据清空时机错误

**解决方法**:
- 确认使用 `setTimeout` 延迟300ms清空
- 检查 `closeDetailPopup` 方法实现

---

## 📊 性能测试

### 1. 加载性能测试

**测试指标**:
- 首屏加载时间 < 3秒
- 分包加载时间 < 2秒
- 图片加载优化

**测试方法**:
1. 使用微信开发者工具的性能面板
2. 记录首屏加载时间
3. 检查网络请求时间
4. 检查资源大小

### 2. 运行性能测试

**测试指标**:
- 页面滚动流畅（60fps）
- 动画流畅
- 无卡顿

**测试方法**:
1. 使用微信开发者工具的性能面板
2. 检查 FPS
3. 检查内存使用
4. 长时间使用测试

---

## ✅ 测试完成确认

**测试人员**: _______________  
**测试日期**: _______________  
**测试结果**: 
- [ ] 通过
- [ ] 发现问题（见下方）

**发现的问题**:
_________________________________
_________________________________
_________________________________

---

**最后更新**: 2025年1月

