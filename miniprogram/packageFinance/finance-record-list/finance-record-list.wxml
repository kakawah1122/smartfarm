<view class="page-container">
  <navigation-bar 
    title="财务记录"
    show-back="true"
    show-menu="false"
    show-record="false"
    fallback-url="/packageFinance/finance/finance"
    bind:back="goBack"
  />

  <!-- 内容区域 -->
  <view class="content-wrapper">
    <!-- 筛选标签 -->
    <view class="filter-tabs">
      <view 
        wx:for="{{typeTabs}}" 
        wx:key="value"
        class="filter-tab {{currentType === item.value ? 'active' : ''}}"
        bind:tap="onTypeChange"
        data-type="{{item.value}}"
      >
        {{item.label}}
      </view>
    </view>

    <!-- 记录列表 -->
    <scroll-view 
      class="list-container" 
      scroll-y
      bindscroll="{{virtualRenderEnabled ? 'onScroll' : ''}}"
    >
      <view class="records-list">
        <!-- 虚拟渲染顶部占位（仅在启用虚拟渲染时显示） -->
        <view 
          wx:if="{{virtualRenderEnabled && virtualTopHeight > 0}}" 
          style="height: {{virtualTopHeight}}px;"
        ></view>
        
        <!-- 记录列表（保持原有结构不变） -->
        <view 
          wx:for="{{displayRecords}}" 
          wx:key="id"
          class="record-item-card"
          bind:tap="viewRecordDetail"
          data-item="{{item}}"
        >
          <view class="record-left">
            <view class="record-content">
              <view class="record-title">{{item.title}}</view>
              <view class="record-desc">{{item.description}}</view>
              <view class="record-footer">
                <text class="record-time">{{item.date}}</text>
              </view>
            </view>
          </view>
          <view class="record-right">
            <view class="record-amount {{item.type}}">
              {{item.type === 'income' ? '+' : '-'}}¥{{item.amount}}
            </view>
          </view>
        </view>
        
        <!-- 虚拟渲染底部占位（仅在启用虚拟渲染时显示） -->
        <view 
          wx:if="{{virtualRenderEnabled && virtualBottomHeight > 0}}" 
          style="height: {{virtualBottomHeight}}px;"
        ></view>
      </view>
      
      <!-- 底部安全区域占位 -->
      <view class="safe-area"></view>
    </scroll-view>
  </view>
  
  <!-- 交易详情弹窗组件 -->
  <finance-record-detail
    visible="{{showDetailPopup}}"
    record="{{selectedRecord}}"
    bind:close="closeDetailPopup"
  />
  
  <!-- 虚拟渲染已默认开启（生产环境） -->
</view>

