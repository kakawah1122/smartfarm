<view class="death-records-page">
  
  <!-- 自定义导航栏 -->
  <navigation-bar title="死亡记录" showBack="{{true}}" />
  
  <!-- 加载中 -->
  <view class="loading-container" wx:if="{{loading}}">
    <t-loading theme="circular" size="40rpx" text="加载中..." />
  </view>

  <!-- 记录列表 -->
  <view class="records-list" wx:else>
    
    <!-- 空状态 -->
    <view class="empty-container" wx:if="{{records.length === 0}}">
      <t-empty 
        icon="info-circle" 
        description="暂无死亡记录"
      />
    </view>

    <!-- 记录卡片 -->
    <view 
      class="record-card"
      wx:for="{{records}}" 
      wx:key="_id"
      bind:tap="onRecordTap"
      data-id="{{item._id}}"
    >
      <!-- 记录头部：死因 -->
      <view class="record-header">
        <view class="record-title-row">
          <text class="record-name">{{item.deathCause || '未知死因'}}</text>
        </view>
      </view>

      <!-- 记录内容 -->
      <view class="record-content">
        <!-- 第一行：批次号 + 死亡数量 + 损失 -->
        <view class="info-row">
          <view class="info-group">
            <text class="info-label">批次：</text>
            <text class="info-value">{{item.batchNumber || '未知'}}</text>
          </view>
          <view class="info-group">
            <text class="info-label">死亡：</text>
            <text class="info-value death-count">{{item.deathCount}} 只</text>
          </view>
          <view class="info-group">
            <text class="info-label">损失：</text>
            <text class="info-value loss-value">¥{{item.financeLoss || 0}}</text>
          </view>
        </view>

        <!-- 第二行：修正后的死因（如果存在） -->
        <view class="info-row" wx:if="{{item.isCorrected}}">
          <view class="info-group full-width">
            <text class="info-label">修正后：</text>
            <text class="info-value corrected-cause">{{item.correctedCause}}</text>
          </view>
        </view>

        <!-- 底部：日期 + 记录者 + 状态 -->
        <view class="record-footer">
          <view class="footer-left">
            <text class="date-text">{{item.deathDate}}</text>
            <text class="operator-text">{{item.reporterName || 'KAKA'}}</text>
          </view>
          <t-tag 
            theme="{{item.isCorrected ? 'success' : 'warning'}}" 
            size="small" 
            class="status-tag"
          >
            {{item.isCorrected ? '已修正' : '待确认'}}
          </t-tag>
        </view>
      </view>
    </view>

  </view>

  <!-- 底部安全区域 -->
  <view class="safe-area-bottom"></view>

</view>

