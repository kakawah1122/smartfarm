<!--profile.wxml - é‡æ–°è®¾è®¡çš„ä¸ªäººä¸­å¿ƒé¡µé¢-->
<view class="profile-page">
  <!-- æ–°å¼å¯¼èˆªæ  -->
  <navigation-bar 
    title="ä¸ªäººä¸­å¿ƒ"
    show-back="{{true}}"
    show-menu="{{true}}"
    show-record="{{false}}"
    bind:back="goBack"
    bind:menu="onSettingsTap"
  />
  
  <scroll-view class="profile-content" scroll-y>
    <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ - ä¿ç•™åŸè®¾è®¡ -->
    <view class="user-info-section">
      <view class="user-card">
        <view class="user-info">
          <view class="user-avatar" bind:tap="changeAvatar">
            <image 
              wx:if="{{userInfo.avatarUrl}}"
              class="avatar-image" 
              src="{{userInfo.avatarUrl}}"
              mode="aspectFill"
            />
            <text wx:else class="default-avatar">ğŸ‘¤</text>
          </view>
          <view class="user-details">
            <view class="user-name-row">
              <text class="user-name" bind:tap="editProfile">{{userInfo.name}}</text>
              <text class="user-role-badge">{{userInfo.role}}</text>
            </view>
            <text class="user-farm">{{userInfo.farm}}</text>
          </view>
          <view wx:if="{{notifications.length > 0}}" class="notification-area" bind:tap="showNotifications">
            <view class="notification-badge">{{notifications.length}}</view>
            <view class="notification-icon">ğŸ””</view>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½èœå• -->
    <view class="menu-section">
      <view class="section-title">åŠŸèƒ½èœå•</view>
      <view class="tdesign-card-grid">
        <t-card 
          wx:for="{{menuItems}}" 
          wx:key="id"
          class="tdesign-menu-card"
          bind:tap="navigateToMenu"
          data-item="{{item}}">
          <view class="tdesign-card-content">
            <view class="tdesign-card-icon-wrapper">
              <view class="tdesign-card-icon">
                <text wx:if="{{item.icon === 'money-circle'}}">ğŸ’°</text>
                <text wx:elif="{{item.icon === 'user-group'}}">ğŸ‘¥</text>
                <text wx:elif="{{item.icon === 'file-text'}}">ğŸ“‹</text>
                <text wx:else>âš™ï¸</text>
              </view>
              <view wx:if="{{item.badge}}" class="tdesign-card-badge">{{item.badge}}</view>
            </view>
            <view class="tdesign-card-info">
              <view class="tdesign-card-title">{{item.title}}</view>
              <view class="tdesign-card-description">{{item.description}}</view>
            </view>
            <view class="tdesign-card-arrow">â€º</view>
          </view>
        </t-card>
      </view>
    </view>



    <!-- ç™»å½•/é€€å‡ºç™»å½• -->
    <view class="auth-section">
      <t-button 
        wx:if="{{!isLoggedIn}}"
        theme="primary" 
        size="large" 
        block 
        bind:tap="goToLogin"
        class="login-btn"
      >
        ç™»å½•
      </t-button>
      
      <t-button 
        wx:else
        theme="danger" 
        size="large" 
        block 
        bind:tap="logout"
        class="logout-btn"
      >
        é€€å‡ºç™»å½•
      </t-button>
    </view>

    <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
    <view class="safe-area-bottom"></view>
  </scroll-view>
</view>