<!--profile.wxml - 重新设计的个人中心页面-->
<view class="profile-page">
  <!-- 新式导航栏 -->
  <navigation-bar 
    title="个人中心"
    show-back="{{true}}"
    show-menu="{{true}}"
    show-record="{{false}}"
    bind:back="goBack"
    bind:menu="onSettingsTap"
  />
  
  <scroll-view class="profile-content" scroll-y>
    <!-- 用户信息卡片 - 保留原设计 -->
    <view class="user-info-section">
      <view class="user-card">
        <view class="user-info">
          <view class="user-avatar" bind:tap="changeAvatar">
            <image 
              wx:if="{{userInfo.avatarUrl}}"
              class="avatar-image" 
              src="{{userInfo.avatarUrl}}"
              mode="aspectFill"
            />
            <text wx:else class="default-avatar">👤</text>
          </view>
          <view class="user-details">
            <view class="user-name-row">
              <text class="user-name" bind:tap="editProfile">{{userInfo.name}}</text>
              <text class="user-role-badge">{{userInfo.role}}</text>
            </view>
            <text class="user-farm">{{userInfo.farm}}</text>
          </view>
          <view wx:if="{{notifications.length > 0}}" class="notification-area" bind:tap="showNotifications">
            <view class="notification-badge">{{notifications.length}}</view>
            <view class="notification-icon">🔔</view>
          </view>
        </view>
      </view>
    </view>

    <!-- 功能菜单 -->
    <view class="menu-section">
      <view class="section-title">功能菜单</view>
      <view class="tdesign-card-grid">
        <t-card 
          wx:for="{{menuItems}}" 
          wx:key="id"
          class="tdesign-menu-card"
          bind:tap="navigateToMenu"
          data-item="{{item}}">
          <view class="tdesign-card-content">
            <view class="tdesign-card-icon-wrapper">
              <view class="tdesign-card-icon">
                <text wx:if="{{item.icon === 'money-circle'}}">💰</text>
                <text wx:elif="{{item.icon === 'user-group'}}">👥</text>
                <text wx:elif="{{item.icon === 'file-text'}}">📋</text>
                <text wx:else>⚙️</text>
              </view>
              <view wx:if="{{item.badge}}" class="tdesign-card-badge">{{item.badge}}</view>
            </view>
            <view class="tdesign-card-info">
              <view class="tdesign-card-title">{{item.title}}</view>
              <view class="tdesign-card-description">{{item.description}}</view>
            </view>
            <view class="tdesign-card-arrow">›</view>
          </view>
        </t-card>
      </view>
    </view>



    <!-- 登录/退出登录 -->
    <view class="auth-section">
      <t-button 
        wx:if="{{!isLoggedIn}}"
        theme="primary" 
        size="large" 
        block 
        bind:tap="goToLogin"
        class="login-btn"
      >
        登录
      </t-button>
      
      <t-button 
        wx:else
        theme="danger" 
        size="large" 
        block 
        bind:tap="logout"
        class="logout-btn"
      >
        退出登录
      </t-button>
    </view>

    <!-- 底部安全区域 -->
    <view class="safe-area-bottom"></view>
  </scroll-view>
</view>