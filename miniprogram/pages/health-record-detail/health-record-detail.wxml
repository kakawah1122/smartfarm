<!--health-record-detail.wxml - å¥åº·è®°å½•è¯¦æƒ…é¡µé¢-->
<view class="page-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <navigation-bar 
    title="å¥åº·è®°å½•è¯¦æƒ…"
    show-back="true"
    show-menu="false"
    show-record="false"
    bind:back="goBack"
  />

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <t-loading theme="spinner" size="40rpx" text="åŠ è½½ä¸­..." />
  </view>

  <!-- ç©ºæ•°æ®çŠ¶æ€ -->
  <view wx:elif="{{!record.id}}" class="empty-container">
    <view class="empty-icon">ğŸ“</view>
    <view class="empty-text">æš‚æ— è®°å½•ä¿¡æ¯</view>
    <t-button theme="primary" size="medium" bind:tap="goBack" class="empty-btn primary-button">
      è¿”å›åˆ—è¡¨
    </t-button>
  </view>

  <!-- é¡µé¢å†…å®¹ -->
  <view wx:else class="content-container">
    <!-- è®°å½•çŠ¶æ€å¡ç‰‡ -->
    <view class="status-card">
      <view class="card-header">
        <text class="card-title">è®°å½•çŠ¶æ€</text>
        <t-tag theme="{{record.severity || 'default'}}" size="medium">{{record.priorityText || 'æœªçŸ¥'}}</t-tag>
      </view>
      <view class="status-info">
        <text class="status-text">{{record.status}}</text>
        <text class="record-date">è®°å½•æ—¶é—´ï¼š{{record.date}} {{record.time}}</text>
      </view>
    </view>

    <!-- åŸºæœ¬ä¿¡æ¯ - ä½¿ç”¨TDesign Cellç»„ä»¶å®ç°å¡ç‰‡æ•ˆæœ -->
    <view class="card-section">
      <view class="section-title">åŸºæœ¬ä¿¡æ¯</view>
      <t-cell-group class="card-cell-group">
        <t-cell title="è¯Šæ–­ç—…ç§" note="{{record.location || 'æœªç¡®è¯Š'}}" hover />
        <t-cell title="å¼‚å¸¸æ•°é‡" note="{{record.affectedCount}}åª" hover />
        <t-cell title="ä¸¥é‡ç¨‹åº¦" note="{{record.priorityText}}" hover />
        <t-cell title="è®°å½•äººå‘˜" note="{{record.operator}}" hover />
      </t-cell-group>
    </view>

    <!-- ç—‡çŠ¶æè¿° -->
    <view class="card-section">
      <view class="section-title">ç—‡çŠ¶æè¿°</view>
      <t-cell-group class="card-cell-group">
        <view class="content-cell">
          <text class="content-text">{{record.symptoms || 'æ— ç—‡çŠ¶æè¿°'}}</text>
        </view>
      </t-cell-group>
    </view>

    <!-- æ²»ç–—æ–¹æ¡ˆ -->
    <view class="card-section">
      <view class="section-title">æ²»ç–—æ–¹æ¡ˆ</view>
      <t-cell-group class="card-cell-group">
        <view class="content-cell">
          <text class="content-text">{{record.treatment || 'æš‚æ— æ²»ç–—æ–¹æ¡ˆ'}}</text>
        </view>
      </t-cell-group>
    </view>

    <!-- å¤„ç†æƒ…å†µ -->
    <view wx:if="{{record.hasFollowUp}}" class="card-section">
      <view class="section-title">å¤„ç†æƒ…å†µ</view>
      <t-cell-group class="card-cell-group">
        <t-cell wx:if="{{record.curedCount > 0}}" title="å·²æ²»æ„ˆ" note="{{record.curedCount}}åª" hover />
        <t-cell wx:if="{{record.deathCount > 0}}" title="å·²æ­»äº¡" note="{{record.deathCount}}åª" hover />
        <t-cell wx:if="{{record.remainingCount > 0}}" title="æ²»ç–—ä¸­" note="{{record.remainingCount}}åª" hover />
      </t-cell-group>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-section">
      <t-button 
        wx:if="{{record.canFollowUp}}"
        theme="primary" 
        size="large" 
        block 
        bind:tap="goToFollowUp"
        class="action-btn"
      >
        è·Ÿè¿›æ²»ç–—
      </t-button>
      
      <t-button 
        theme="default" 
        size="large" 
        block 
        bind:tap="goBack"
        class="action-btn"
      >
        è¿”å›åˆ—è¡¨
      </t-button>
    </view>
  </view>
</view>
