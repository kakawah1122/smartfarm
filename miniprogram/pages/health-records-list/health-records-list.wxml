<!--health-records-list.wxml - 健康记录列表页面-->
<view class="page page-container">
  <!-- 自定义导航栏 -->
  <navigation-bar 
    title="健康记录"
    show-back="true"
    show-menu="false"
    show-record="false"
    bind:back="goBack"
  />

  <!-- 筛选和统计信息 -->
  <view class="filter-section">
    <view class="filter-header">
      <view class="record-count">
        共找到 <text class="count-number">{{filteredCount}}</text> 条记录
      </view>
      <view class="header-actions">
        <t-button 
          theme="default" 
          size="extra-small" 
          bind:tap="toggleFilter"
          icon="filter"
          class="filter-btn"
        >
          筛选
        </t-button>
      </view>
    </view>

    <!-- 筛选面板 -->
    <t-overlay visible="{{showFilter}}" bind:click="closeFilter">
      <view class="filter-panel" catchtap="preventClose">
        <view class="filter-title">筛选条件</view>
        
        <!-- 月份筛选 -->
        <view class="filter-item">
          <view class="filter-label">选择月份</view>
          <picker
            bindchange="onMonthChange"
            range="{{monthOptions}}"
            range-key="label"
          >
            <view class="filter-value">
              {{selectedMonthLabel || '全部月份'}}
            </view>
          </picker>
        </view>

        <!-- 状态筛选 -->
        <view class="filter-item">
          <view class="filter-label">记录状态</view>
          <picker
            bindchange="onResultChange"
            range="{{resultOptions}}"
            range-key="label"
          >
            <view class="filter-value">
              {{selectedResultLabel || '全部状态'}}
            </view>
          </picker>
        </view>

        <!-- 操作按钮 -->
        <view class="filter-actions">
          <t-button theme="default" bind:tap="resetFilter" class="filter-action-btn">
            重置
          </t-button>
          <t-button theme="primary" bind:tap="applyFilter" class="filter-action-btn">
            确定
          </t-button>
        </view>
      </view>
    </t-overlay>
  </view>

  <!-- 记录列表 -->
  <view class="records-container">
    <!-- 加载状态 -->
    <view wx:if="{{loading && healthRecords.length === 0}}" class="loading-container">
      <t-loading theme="spinner" size="40rpx" text="加载中..." />
    </view>

    <!-- 空数据状态 -->
    <view wx:elif="{{!loading && healthRecords.length === 0}}" class="empty-container">
      <t-empty 
        icon="heart" 
        description="暂无健康记录"
        action-text="添加记录"
        bind:action="addHealthRecord"
      />
    </view>

    <!-- 记录列表 -->
    <view wx:else>
      <view wx:for="{{healthRecords}}" wx:key="id" 
            class="record-item" 
            bind:tap="viewHealthRecord" 
            data-item="{{item}}">
        <view class="record-main">
          <view class="record-header">
            <text class="record-location">{{item.location}}</text>
            <t-tag theme="{{item.severity}}" size="small">{{item.priorityText}}</t-tag>
          </view>
          <view class="record-content">
            <text class="record-symptoms">{{item.symptoms}}</text>
          </view>
          <view class="record-footer">
            <view class="record-info">
              <text class="record-operator">{{item.operator}}</text>
              <text class="record-date">{{item.date}} {{item.time}}</text>
            </view>
            <view class="record-status">
              <text class="status-text">{{item.status}}</text>
            </view>
          </view>
        </view>
        <view class="record-arrow">
          <t-icon name="chevron-right" size="16" color="#c8c9cc" />
        </view>
      </view>

      <!-- 加载更多 -->
      <view wx:if="{{loading && healthRecords.length > 0}}" class="load-more">
        <t-loading theme="spinner" size="32rpx" text="加载更多..." />
      </view>

      <!-- 没有更多数据 -->
      <view wx:elif="{{!hasMore && healthRecords.length > 0}}" class="no-more">
        <text class="no-more-text">没有更多记录了</text>
      </view>
    </view>
  </view>

</view>
