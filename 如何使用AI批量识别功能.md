# 📖 如何使用AI批量识别功能

## 🎯 适用场景

您有一张包含**多天鹅价数据的表格截图**（如图2所示），想要一次性将所有数据录入到系统中。

---

## 📱 操作步骤

### 步骤 1：进入鹅价管理页面

1. 打开小程序
2. 点击底部导航栏 **"个人中心"**
3. 点击 **"鹅价管理"**

### 步骤 2：切换到AI识别模式

1. 在鹅价管理页面，点击顶部的 **"AI识别"** 标签
2. 看到"AI智能识别"区域

### 步骤 3：上传价格表格截图

1. 点击 **"点击上传截图"** 区域
2. 选择相册中的价格表格截图
   - 建议：清晰的表格截图
   - 支持格式：JPG、PNG
3. 图片上传成功后会显示预览

### 步骤 4：开始AI识别

1. 点击 **"开始AI识别"** 按钮
2. 等待AI分析（约15-30秒）
   - 会显示"AI正在分析图片内容..."
   - 批量识别比单条识别耗时稍长，请耐心等待

### 步骤 5：查看识别结果

AI识别完成后，会显示：

```
✅ AI识别成功！共识别到 10 条数据，请确认后保存
```

然后出现**批量数据预览**界面：

```
┌──────────────────────────────────┐
│ 批量数据预览  [ 共 10 条记录 ]    │
├──────────────────────────────────┤
│ ┌────────────────────────────┐   │
│ │ 2025-10-30     第 1 条     │   │
│ │ ────────────────────────── │   │
│ │ 鹅苗价格（元/只）           │   │
│ │ 中种鹅   38-41   ¥39.5     │   │
│ │ 大种鹅   52-54   ¥53.0     │   │
│ │ 特大种鹅  56-60   ¥58.0    │   │
│ │ 肉鹅价格（元/斤）           │   │
│ │ 120日龄  18.5-18.5  ¥18.5  │   │
│ │ 130日龄  19.0-19.0  ¥19.0  │   │
│ └────────────────────────────┘   │
│                                  │
│ ┌────────────────────────────┐   │
│ │ 2025-10-31     第 2 条     │   │
│ │ ...                        │   │
│ └────────────────────────────┘   │
│                                  │
│ （更多记录...）                  │
└──────────────────────────────────┘
```

### 步骤 6：确认数据

1. 仔细检查每条记录的：
   - ✅ 日期是否正确
   - ✅ 价格区间是否准确
   - ✅ 平均价格计算是否合理

2. 如果发现错误：
   - 点击 **"取消"** 按钮
   - 重新上传更清晰的截图
   - 或者使用"手动录入"模式修正

### 步骤 7：批量保存

1. 确认数据无误后，点击 **"确认批量保存（10条）"** 按钮
2. 系统会显示保存进度：
   ```
   保存中...1/10
   保存中...2/10
   ...
   保存中...10/10
   ```
3. 保存完成后，显示结果：
   ```
   ✅ 批量保存成功！新增 8 条，更新 2 条
   ```

### 步骤 8：验证结果

1. 向下滚动，查看 **"最近更新记录"** 区域
   - 应该看到刚才保存的所有日期

2. 返回首页，点击 **"鹅价详情"** 卡片
   - 查看趋势图
   - 应该显示完整的多天价格走势

---

## 🎨 示例：导入10月30日~11月8日的数据

### 您的截图（如图2）
```
┌────────────────────────────────────────┐
│     2025/11/8狮头鹅鹅苗价格表           │
├────────────────────────────────────────┤
│ 日期 │ 中种鹅 │ 大种鹅 │ 特大种鹅 │ 备注│
│ 10-30│ 38-41 │ 52-54 │ 56-60 │ 跌 │
│ 10-31│ 38-41 │ 52-54 │ 56-60 │    │
│ 11-01│ 36-39 │ 50-52 │ 54-58 │ 跌 │
│ 11-02│ 36-39 │ 50-52 │ 54-58 │    │
│ ...                                    │
│ 11-08│ 26-29 │ 40-42 │ 44-48 │ 跌 │
└────────────────────────────────────────┘
```

### AI识别结果
```json
{
  "records": [
    {
      "date": "2025-10-30",
      "goslingBreeds": [
        {"key": "middle", "label": "中种鹅", "min": 38, "max": 41},
        {"key": "large", "label": "大种鹅", "min": 52, "max": 54},
        {"key": "extraLarge", "label": "特大种鹅", "min": 56, "max": 60}
      ],
      "meatBreeds": [
        {"key": "meat120", "label": "肉鹅120日龄", "min": 18.5, "max": 18.5},
        {"key": "meat130", "label": "肉鹅130日龄", "min": 19.0, "max": 19.0}
      ]
    },
    {
      "date": "2025-10-31",
      ...
    },
    ...
  ]
}
```

### 保存到数据库
```
goose_prices 集合：

_id: "xxx1", date: "2025-10-30", goslingBreeds: [...], meatBreeds: [...]
_id: "xxx2", date: "2025-10-31", goslingBreeds: [...], meatBreeds: [...]
_id: "xxx3", date: "2025-11-01", goslingBreeds: [...], meatBreeds: [...]
...
_id: "xxx10", date: "2025-11-08", goslingBreeds: [...], meatBreeds: [...]
```

---

## ⚠️ 常见问题

### Q1: AI识别不准确怎么办？

**解决方案**：
1. **重新拍照**：确保表格清晰、光线充足、无遮挡
2. **裁剪截图**：只保留价格表格部分，去掉无关内容
3. **手动录入**：切换到"手动录入"模式，逐条输入

### Q2: 识别出的日期错误？

**原因**：
- 图片中的日期格式不清晰
- AI无法准确识别月份/日期

**解决方案**：
- 在预览界面检查日期
- 如果错误，点击"取消"，使用手动录入修正

### Q3: 部分日期数据缺失？

**原因**：
- AI可能遗漏了某些行
- 或者某些行的数据不完整

**解决方案**：
1. 批量保存已识别的数据
2. 对缺失的日期，使用"手动录入"补充

### Q4: 保存时提示"更新X条"是什么意思？

**解释**：
- 系统发现数据库中已经存在这些日期的数据
- 会用新数据覆盖旧数据
- 这是正常的智能去重机制

### Q5: 识别时间太长了？

**解释**：
- 批量识别需要AI分析更多内容
- 10条记录通常需要15-30秒
- 这是正常现象，请耐心等待

**优化建议**：
- 一次不要上传太多日期的数据（建议10-15天内）
- 如果超过20天，可以分批上传

### Q6: 如何知道数据是否保存成功？

**验证方法**：
1. 查看"最近更新记录"区域
2. 返回首页，查看"鹅价详情"趋势图
3. 或者在云开发控制台查看 `goose_prices` 集合

---

## 💡 使用技巧

### 技巧1：拍照建议
- ✅ 使用手机相机的"文档模式"
- ✅ 确保表格边界清晰
- ✅ 避免反光和阴影
- ✅ 水平拍摄，避免倾斜

### 技巧2：截图建议
- ✅ 只保留价格表格部分
- ✅ 裁剪掉无关的标题、页脚
- ✅ 确保数字清晰可读

### 技巧3：分批导入
如果有很多历史数据：
- 第1次：上传最近10天的数据
- 第2次：上传再往前10天的数据
- 依次类推

### 技巧4：定期更新
- 每天/每周上传最新的价格表格
- 系统会自动更新已存在的日期
- 保持数据实时性

---

## 📊 预期效果

批量识别和保存完成后，您将获得：

1. **完整的历史数据**
   - 数据库中有所有日期的记录
   - 可以查询任意日期的价格

2. **完整的趋势图**
   - 在"鹅价详情"页面
   - 显示多天的价格走势曲线
   - 直观看到价格涨跌

3. **AI预测基础**
   - 为未来的AI价格预测功能提供数据支持
   - 更多历史数据 = 更准确的预测

---

## 🎉 总结

使用AI批量识别功能，您可以：
- ⚡ **快速导入**：10秒上传，30秒识别，10秒保存
- 📊 **批量处理**：一次处理10+条记录
- 🔄 **自动去重**：无需担心重复录入
- 💯 **高准确率**：Qwen-VL-Max 模型保证识别质量

**从此告别逐条手动录入，享受智能化的鹅价管理！** 🎊

---

**需要帮助？** 查看 [AI批量识别功能说明-v2.0.md](./AI批量识别功能说明-v2.0.md) 了解更多技术细节。

