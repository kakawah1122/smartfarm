# 鹅数通项目测试清单

**更新时间**: 2025年10月21日  
**版本**: v1.0

---

## 一、功能测试清单

### 1.1 入栏管理模块

#### 测试用例 1.1.1：创建入栏记录
- [ ] **测试步骤**:
  1. 打开生产管理页面
  2. 点击"入栏登记"
  3. 填写批次信息（批次号、数量、品种、日期）
  4. 提交表单
  
- [ ] **预期结果**:
  - ✅ 批次记录创建成功
  - ✅ 显示成功提示
  - ✅ 自动生成待办任务
  - ✅ 自动创建初始健康检查记录
  - ✅ 跳转到批次列表页面

#### 测试用例 1.1.2：查看入栏记录
- [ ] **测试步骤**:
  1. 打开入栏记录列表
  2. 查看记录详情
  
- [ ] **预期结果**:
  - ✅ 显示所有入栏记录
  - ✅ 显示批次号、数量、品种、日期
  - ✅ 可以查看详情

#### 测试用例 1.1.3：批次编号自动生成
- [ ] **测试步骤**:
  1. 打开入栏表单
  2. 查看批次号字段
  
- [ ] **预期结果**:
  - ✅ 批次号自动生成（格式：QY-YYYYMMDD）
  - ✅ 可以手动修改

---

### 1.2 养殖任务模块

#### 测试用例 1.2.1：查看待办任务
- [ ] **测试步骤**:
  1. 打开养殖任务页面
  2. 选择批次
  3. 查看当日任务
  
- [ ] **预期结果**:
  - ✅ 显示批次对应日龄的任务
  - ✅ 任务分类显示（疫苗、用药、护理、饲养）
  - ✅ 显示任务详情和用量

#### 测试用例 1.2.2：完成疫苗任务
- [ ] **测试步骤**:
  1. 选择一个疫苗任务
  2. 点击"完成任务"
  3. 填写疫苗信息（疫苗名称、用量、兽医信息）
  4. 提交
  
- [ ] **预期结果**:
  - ✅ 任务标记为已完成
  - ✅ 自动创建疫苗接种健康记录
  - ✅ 健康记录关联任务ID
  - ✅ 设置7天后跟进提醒
  - ✅ 显示成功提示

#### 测试用例 1.2.3：完成普通任务
- [ ] **测试步骤**:
  1. 选择用药/护理/饲养任务
  2. 点击"完成任务"
  3. 填写备注（可选）
  4. 提交
  
- [ ] **预期结果**:
  - ✅ 任务标记为已完成
  - ✅ 显示成功提示

#### 测试用例 1.2.4：一周任务视图
- [ ] **测试步骤**:
  1. 打开养殖任务页面
  2. 点击"一周任务"
  3. 查看任务列表
  
- [ ] **预期结果**:
  - ✅ 显示未来7天的任务
  - ✅ 按日期分组显示
  - ✅ 显示任务数量统计

---

### 1.3 健康管理模块

#### 测试用例 1.3.1：批次加载（关键测试）
- [ ] **测试步骤**:
  1. 打开健康管理页面
  2. 查看批次列表
  
- [ ] **预期结果**:
  - ✅ 批次列表正常加载
  - ✅ **不出现 "currentBatchId undefined" 错误**
  - ✅ 显示批次编号、品种、日龄、数量
  - ✅ 显示健康率、患病数、死亡数

#### 测试用例 1.3.2：批次筛选
- [ ] **测试步骤**:
  1. 点击右上角"筛选"按钮
  2. 查看批次选择器
  3. 选择不同批次
  
- [ ] **预期结果**:
  - ✅ 显示所有存栏批次
  - ✅ 当前批次高亮显示
  - ✅ 点击批次后切换成功
  - ✅ 显示切换成功提示

#### 测试用例 1.3.3：出栏批次过滤（关键测试）
- [ ] **测试步骤**:
  1. 创建测试批次（入栏1000只）
  2. 完全出栏该批次（出栏1000只）
  3. 刷新健康管理页面
  4. 检查批次列表
  
- [ ] **预期结果**:
  - ✅ **完全出栏的批次不显示**
  - ✅ 部分出栏的批次仍显示（显示剩余数量）
  - ✅ 未出栏的批次正常显示

#### 测试用例 1.3.4：健康记录创建
- [ ] **测试步骤**:
  1. 打开健康检查页面
  2. 填写健康记录
  3. 提交
  
- [ ] **预期结果**:
  - ✅ 记录创建成功
  - ✅ 显示在健康记录列表
  - ✅ 更新批次健康统计

#### 测试用例 1.3.5：自动创建健康记录（关键测试）
- [ ] **测试步骤**:
  1. 创建入栏记录
  2. 查看健康记录列表
  3. 验证初始健康检查记录
  
- [ ] **预期结果**:
  - ✅ 自动创建初始健康检查记录
  - ✅ 记录类型为 "initial_check"
  - ✅ 标记为 autoCreated: true
  - ✅ creationSource: 'entry'
  - ✅ 默认全部健康

#### 测试用例 1.3.6：疫苗任务联动（关键测试）
- [ ] **测试步骤**:
  1. 完成疫苗任务
  2. 查看健康记录列表
  3. 验证疫苗健康记录
  
- [ ] **预期结果**:
  - ✅ 自动创建疫苗接种健康记录
  - ✅ 记录包含疫苗信息
  - ✅ 关联任务ID (relatedTaskId)
  - ✅ 标记为 autoCreated: true
  - ✅ creationSource: 'task'
  - ✅ 设置7天后跟进提醒

---

### 1.4 物料管理模块

#### 测试用例 1.4.1：物料采购
- [ ] **测试步骤**:
  1. 打开物料采购页面
  2. 填写采购信息
  3. 提交
  
- [ ] **预期结果**:
  - ✅ 采购记录创建成功
  - ✅ 库存数量增加
  - ✅ 生成成本记录

#### 测试用例 1.4.2：物料使用
- [ ] **测试步骤**:
  1. 打开物料使用页面
  2. 选择物料和批次
  3. 填写使用数量
  4. 提交
  
- [ ] **预期结果**:
  - ✅ 使用记录创建成功
  - ✅ 库存数量减少
  - ✅ 关联批次

#### 测试用例 1.4.3：库存查询
- [ ] **测试步骤**:
  1. 打开库存详情页面
  2. 查看物料列表
  
- [ ] **预期结果**:
  - ✅ 显示所有物料
  - ✅ 显示当前库存
  - ✅ 库存数量准确

---

### 1.5 出栏管理模块

#### 测试用例 1.5.1：创建出栏记录
- [ ] **测试步骤**:
  1. 打开出栏表单
  2. 选择批次
  3. 填写出栏数量
  4. 提交
  
- [ ] **预期结果**:
  - ✅ 出栏记录创建成功
  - ✅ 存栏数量更新
  - ✅ 如果完全出栏，批次状态更新

#### 测试用例 1.5.2：部分出栏
- [ ] **测试步骤**:
  1. 创建测试批次（1000只）
  2. 出栏300只
  3. 查看健康页面
  
- [ ] **预期结果**:
  - ✅ 批次仍显示在健康页面
  - ✅ 显示剩余数量（700只）
  - ✅ 健康统计基于当前存栏

#### 测试用例 1.5.3：完全出栏
- [ ] **测试步骤**:
  1. 创建测试批次（1000只）
  2. 分两次出栏（500 + 500）
  3. 查看健康页面
  
- [ ] **预期结果**:
  - ✅ 批次不再显示在健康页面
  - ✅ 出栏记录保留
  - ✅ 财务统计正确

---

### 1.6 财务管理模块

#### 测试用例 1.6.1：成本统计
- [ ] **测试步骤**:
  1. 打开财务管理页面
  2. 查看成本分析
  
- [ ] **预期结果**:
  - ✅ 显示各类成本
  - ✅ 数据准确
  - ✅ 图表显示正确

#### 测试用例 1.6.2：收支统计
- [ ] **测试步骤**:
  1. 查看收支报表
  2. 选择时间范围
  
- [ ] **预期结果**:
  - ✅ 显示收入和支出
  - ✅ 计算利润
  - ✅ 数据准确

---

### 1.7 用户管理模块

#### 测试用例 1.7.1：用户登录
- [ ] **测试步骤**:
  1. 打开小程序
  2. 点击登录
  3. 授权
  
- [ ] **预期结果**:
  - ✅ 登录成功
  - ✅ 获取用户信息
  - ✅ 保存登录状态

#### 测试用例 1.7.2：权限控制
- [ ] **测试步骤**:
  1. 使用不同角色账号登录
  2. 访问受限功能
  
- [ ] **预期结果**:
  - ✅ 超级管理员：所有权限
  - ✅ 经理：财务、生产权限
  - ✅ 兽医：健康管理权限
  - ✅ 员工：基本操作权限

---

## 二、性能测试清单

### 2.1 页面加载性能

#### 测试用例 2.1.1：首页加载
- [ ] **测试条件**: 首次加载
- [ ] **测试指标**: 加载时间 < 2秒
- [ ] **测试结果**: _____ 秒

#### 测试用例 2.1.2：健康页面加载
- [ ] **测试条件**: 有10个批次数据
- [ ] **测试指标**: 加载时间 < 2秒
- [ ] **测试结果**: _____ 秒

#### 测试用例 2.1.3：任务页面加载
- [ ] **测试条件**: 有50个待办任务
- [ ] **测试指标**: 加载时间 < 2秒
- [ ] **测试结果**: _____ 秒

### 2.2 云函数响应性能

#### 测试用例 2.2.1：批次查询
- [ ] **测试条件**: 查询所有批次
- [ ] **测试指标**: 响应时间 < 1秒
- [ ] **测试结果**: _____ 秒

#### 测试用例 2.2.2：任务查询
- [ ] **测试条件**: 查询批次任务
- [ ] **测试指标**: 响应时间 < 1秒
- [ ] **测试结果**: _____ 秒

#### 测试用例 2.2.3：健康数据查询
- [ ] **测试条件**: 查询批次健康汇总
- [ ] **测试指标**: 响应时间 < 1秒
- [ ] **测试结果**: _____ 秒

### 2.3 列表滚动性能

#### 测试用例 2.3.1：长列表滚动
- [ ] **测试条件**: 100条记录
- [ ] **测试指标**: 滚动流畅，无卡顿
- [ ] **测试结果**: ✅ / ❌

---

## 三、兼容性测试清单

### 3.1 iOS 设备测试

#### 测试用例 3.1.1：iPhone（iOS 15+）
- [ ] **设备型号**: _________
- [ ] **微信版本**: _________
- [ ] **测试结果**:
  - [ ] 页面显示正常
  - [ ] 功能运行正常
  - [ ] 无崩溃或异常

#### 测试用例 3.1.2：iPad
- [ ] **设备型号**: _________
- [ ] **微信版本**: _________
- [ ] **测试结果**:
  - [ ] 页面显示正常
  - [ ] 适配屏幕尺寸
  - [ ] 功能运行正常

### 3.2 Android 设备测试

#### 测试用例 3.2.1：Android 手机（Android 9+）
- [ ] **设备型号**: _________
- [ ] **微信版本**: _________
- [ ] **测试结果**:
  - [ ] 页面显示正常
  - [ ] 功能运行正常
  - [ ] 无崩溃或异常

#### 测试用例 3.2.2：Android 平板
- [ ] **设备型号**: _________
- [ ] **微信版本**: _________
- [ ] **测试结果**:
  - [ ] 页面显示正常
  - [ ] 适配屏幕尺寸
  - [ ] 功能运行正常

### 3.3 屏幕尺寸适配

#### 测试用例 3.3.1：小屏幕（iPhone SE）
- [ ] **屏幕尺寸**: 375 x 667
- [ ] **测试结果**: 
  - [ ] 内容不溢出
  - [ ] 按钮可点击
  - [ ] 文字清晰可读

#### 测试用例 3.3.2：大屏幕（iPhone 14 Pro Max）
- [ ] **屏幕尺寸**: 430 x 932
- [ ] **测试结果**:
  - [ ] 布局合理
  - [ ] 无空白过多
  - [ ] 视觉协调

---

## 四、安全性测试清单

### 4.1 权限控制

#### 测试用例 4.1.1：未登录访问
- [ ] **测试步骤**:
  1. 清除登录状态
  2. 尝试访问受限页面
  
- [ ] **预期结果**:
  - ✅ 跳转到登录页面
  - ✅ 提示需要登录

#### 测试用例 4.1.2：越权访问
- [ ] **测试步骤**:
  1. 使用普通员工账号
  2. 尝试访问管理员功能
  
- [ ] **预期结果**:
  - ✅ 显示权限不足提示
  - ✅ 无法执行操作

### 4.2 数据安全

#### 测试用例 4.2.1：敏感信息保护
- [ ] **测试检查**:
  - [ ] 代码中无硬编码密码
  - [ ] 无泄露 API 密钥
  - [ ] 用户数据加密传输

#### 测试用例 4.2.2：SQL 注入防护
- [ ] **测试步骤**:
  1. 在输入框输入特殊字符
  2. 提交表单
  
- [ ] **预期结果**:
  - ✅ 特殊字符被正确处理
  - ✅ 无数据库错误

---

## 五、完整流程测试

### 5.1 核心业务流程

#### 测试用例 5.1.1：完整养殖流程
- [ ] **测试步骤**:
  1. 创建入栏记录（1000只，第1日龄）
  2. 验证自动生成待办任务
  3. 验证自动创建初始健康检查
  4. 完成第2日龄疫苗任务
  5. 验证自动创建疫苗健康记录
  6. 查看健康数据统计
  7. 记录物料使用
  8. 创建出栏记录（500只）
  9. 验证存栏数量更新
  10. 再次出栏（500只）
  11. 验证批次不再显示在健康页面
  12. 查看财务统计
  
- [ ] **预期结果**: 所有步骤成功，数据流转正确

---

## 六、回归测试清单

### 6.1 部署后回归测试

**必须测试的关键功能**:

- [ ] 1. 批次加载（不出现 currentBatchId undefined）
- [ ] 2. 出栏批次过滤（完全出栏不显示）
- [ ] 3. 疫苗任务自动创建健康记录
- [ ] 4. 入栏自动创建初始健康检查
- [ ] 5. 批次筛选功能
- [ ] 6. 健康数据统计准确性
- [ ] 7. 物料库存计算正确
- [ ] 8. 财务统计数据准确

---

## 七、测试报告模板

### 测试基本信息
- **测试日期**: _________
- **测试人员**: _________
- **测试环境**: 开发版 / 体验版 / 正式版
- **小程序版本**: _________

### 测试结果统计
- **总测试用例数**: _____
- **通过数量**: _____
- **失败数量**: _____
- **通过率**: _____%

### 发现的问题
| 问题ID | 问题描述 | 严重程度 | 状态 |
|--------|----------|----------|------|
| Bug-001 | ... | 高/中/低 | 未修复/已修复 |

### 测试结论
- [ ] ✅ 通过，可以发布
- [ ] ⚠️ 有问题，需要修复后再测试
- [ ] ❌ 失败，需要重大修复

---

**文档版本**: v1.0  
**最后更新**: 2025年10月21日

